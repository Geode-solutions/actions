on:
  workflow_call:

jobs:
  semantic-commit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.TOKEN }}
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "20"
      - name: Install commitlint
        run: |
          npm install @commitlint/cli @commitlint/config-angular
          echo "module.exports = {extends: ['@commitlint/config-angular'], rules: { 'scope-empty': [2, 'never'],'subject-empty': [2, 'never'], 'subject-max-length': [0], 'body-leading-blank': [0], 'footer-leading-blank': [0], 'header-max-length': [0], 'scope-case': [0], 'subject-case': [0], 'subject-full-stop': [0], 'type-case': [0], 'type-empty': [0]}}" > commitlint.config.js
          npm list --depth=0
      - name: Check commit messages
        run: |
          if npx commitlint --from origin/${{ github.base_ref }} --to origin/${{ github.head_ref }}; then
            echo "At least one valid Angular commit message found."
            exit 0
          else
            echo "No valid Angular commit messages found."
            exit 1
          fi
