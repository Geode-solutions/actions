on: 
  workflow_call:
    outputs:
      new_release:
        description: "Whether a new release was published"
        value: ${{ jobs.run.outputs.new_release }}
    secrets:
      TOKEN:
        required: true
      NPM_TOKEN:
        required: false

jobs:
  run:
    runs-on: ubuntu-latest
    outputs:
      new_release: ${{ steps.semantic.outputs.new_release_published }}
    steps:
    - uses: actions/checkout@v3
      with:
        persist-credentials: false
    - name: Semantic Release
      uses: cycjimmy/semantic-release-action@v3
      id: semantic
      with:
        dry_run: true
      env:
        GITHUB_TOKEN: ${{ secrets.TOKEN }}
        NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
    - name: Do something when a new release published
      run: |
        echo ${{ steps.semantic.outputs.new_release_published }}
        echo ${{ steps.semantic.outputs.new_release_version }}
        echo ${{ steps.semantic.outputs.new_release_major_version }}
        echo ${{ steps.semantic.outputs.new_release_minor_version }}
        echo ${{ steps.semantic.outputs.new_release_patch_version }}